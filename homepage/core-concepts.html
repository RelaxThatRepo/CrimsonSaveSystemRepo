<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Core Concepts - Crimson Save System</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Roboto', sans-serif; line-height: 1.7; padding: 2em; margin: 0 auto; background-color: #121212; color: #e0e0e0; }
        .container { max-width: 900px; margin: 0 auto; background-color: #1e1e1e; padding: 2em 3em; border-radius: 12px; border: 1px solid #333; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5); }
        h1 { color: #DC143C; font-weight: 700; }
        h2 { color: #f5f5f5; font-weight: 400; border-bottom: 1px solid #5e0a1b; padding-bottom: 0.5em; margin-top: 2em; }
        p { color: #b3b3b3; }
        .breadcrumb { margin-bottom: 2em; font-size: 0.9em; }
        .breadcrumb a { color: #DC143C; font-weight: bold; }
        code { background-color: #2c2c2c; padding: 0.2em 0.4em; border-radius: 4px; font-family: 'Courier New', Courier, monospace; }
        ul { padding-left: 20px; }
        li { margin-bottom: 0.5em; }
        .note { background-color: #2c2c2c; border-left: 4px solid #DC143C; padding: 1em; margin: 1em 0; border-radius: 4px; }
        .navigation-buttons { display: flex; justify-content: space-between; margin-top: 3em; border-top: 1px solid #333; padding-top: 1.5em; }
        .nav-button { display: inline-block; padding: 10px 20px; background-color: #333; color: #e0e0e0; border-radius: 6px; text-decoration: none; font-weight: bold; border: 1px solid #444; transition: all 0.3s ease; }
        .nav-button:hover { background-color: #DC143C; border-color: #DC143C; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <p class="breadcrumb"><a href="index.html">← Back to Home</a></p>
        <h1>Core Concepts & Setup</h1>
        <p>The Crimson Save System is built on a decoupled, fragment-based philosophy. This means that instead of one giant "SaveGame" object, each save slot is a directory filled with small, independent "fragments" of data.</p>

        <h2>The Two-Subsystem Design</h2>
        <p>The system is split into two primary managers to cleanly separate data ownership:</p>
        <ul>
            <li>
                <strong><code>UCrimsonSaveGameManagerSubsystem</code> (UGameInstanceSubsystem):</strong>
                This is the "brain" of the system. It lives on the `UGameInstance` and manages data that persists across levels and is tied to the player's session, such as inventory, skills, currency, and player stats. It is responsible for creating, loading, and saving entire slots.
            </li>
            <li>
                <strong><code>UCrimsonSaveWorldManagerSubsystem</code> (UWorldSubsystem):</strong>
                This subsystem lives on the `UWorld` and manages data specific to a single level or map. It's responsible for saving the state of objects *in* the world, such as opened chests, destroyed walls, or defeated mini-bosses.
            </li>
        </ul>

        <h2>The Fragment-Based Approach</h2>
        <p>Every piece of save data inherits from a common base class.</p>
        <ul>
            <li><strong><code>UCrimsonSaveGameFragmentBase</code>:</strong> An abstract base class that all save data "chunks" must inherit from. It's a child of `USaveGame`, so Unreal knows how to serialize it.</li>
            <li><strong><code>UCrimsonSaveGameHeader</code>:</strong> A special fragment that stores the metadata for a save slot, like the <code>SlotName</code>, <code>SaveDateTime</code>, and total <code>PlayTime</code>. This is what you load to populate your "Load Game" menu.</li>
        </ul>
        <div class="note">
            <p>A "Save Slot" on disk (e.g., <code>SaveGames/Slot_0/</code>) is just a folder containing a <code>Header.sav</code> file and multiple fragment files (e.g., <code>Inventory.sav</code>, <code>PlayerStats.sav</code>, <code>WorldState_MyMap.sav</code>).</p>
        </div>

        <h2>The "Saveable" Interfaces</h2>
        <p>To make a game system saveable, you don't talk to the manager directly. Instead, you implement an interface.</p>
        <ul>
            <li><strong><code>ICrimsonSaveableSystem</code>:</strong> Implemented by persistent systems (like `UPlayerInventoryComponent` or `USkillTreeManager`) that want to save their data as a fragment. These systems register themselves with the <code>UCrimsonSaveGameManagerSubsystem</code></li>
            <li><strong><code>ICrimsonSaveableActor</code>:</strong> Implemented by Actors placed in a level (like `AMyChest` or `ADestroyableWall`) that need to save their state. These actors communicate with the <code>UCrimsonSaveWorldManagerSubsystem</code></li>
        </ul>
        
        <h2>PIE (Play-In-Editor) Quick Start</h2>
        <p>The system includes special logic to make testing in-editor easy.</p>
        <ul>
            <li>When the <code>UCrimsonSaveGameManagerSubsystem</code> initializes in PIE, it checks your developer settings.</li>
            <li>It can be configured to automatically load a specific debug save slot (e.g., <code>DefaultPIESaveSlot = 0</code>).</li>
            <li>It can also reset this slot every time you start PIE (<code>bResetPIESaveSlotOnStart = true</code>).</li>
            <li>This logic is *bypassed* if you are starting PIE on your designated <code>MainMenuMap</code>, allowing for normal game flow.</li>
        </ul>

        <div class="navigation-buttons">
            <a href="index.html" class="nav-button">← Back to Home</a>
            <a href="saving-player-data.html" class="nav-button">Saving Player Data →</a>
        </div>
    </div>
</body>
</html>